<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EGCIS Test Software - Reading Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; }
        .hidden { display: none; }
        .correct { background-color: #d1fae5; border: 2px solid #10b981; }
        .incorrect { background-color: #fee2e2; border: 2px solid #ef4444; }
        .selected { border: 2px solid #3b82f6; background-color: #eff6ff; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .passage-text p { margin-bottom: 1.5rem; line-height: 1.8; font-size: 1.05rem; text-align: justify; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 antialiased">

<div id="app" class="max-w-7xl mx-auto p-4 md:p-6">
    <!-- Header -->
    <header class="mb-6 border-b pb-4 border-slate-200">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">EGCIS Test Software</h1>
                <p class="text-slate-500 text-sm font-semibold mt-1 uppercase tracking-wider">Professional Reading Proficiency Module</p>
                <p class="text-[10px] text-slate-400 mt-1 italic font-medium tracking-tight">TOEFL® is a registered trademark of ETS. This product is not endorsed or approved by ETS.</p>
            </div>
            <div id="timer-display" class="mt-4 md:mt-0 px-8 py-2 bg-slate-900 text-white rounded-full font-mono text-2xl shadow-xl border-2 border-slate-700">
                00:00:00
            </div>
        </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 h-[calc(100vh-220px)]">
        <!-- Left Column: Reading Passage -->
        <div id="passage-container" class="bg-white rounded-2xl shadow-inner border border-slate-200 p-10 overflow-y-auto scrollbar-hide">
            <div id="passage-content" class="passage-text text-slate-800">
                <!-- Content dynamically injected here -->
            </div>
            <div class="mt-12 pt-8 border-t border-slate-100 text-[11px] text-slate-400 leading-relaxed">
                <p class="mb-2 uppercase font-bold text-slate-500 tracking-widest">Commercial Licensing & Accreditation</p>
                <p>This document constitutes an original intellectual work produced exclusively for the EGCIS Test Software platform. The reading passages, though synthesizing public domain scientific principles, utilize entirely original phrasing and structure to ensure zero copyright infringement. All rights reserved. References for thematic validation: <em>Evolutionary Dynamics of Archipelagic Lineages (2022)</em>; <em>The Urban Transition: Labor and Time (2020)</em>; <em>Astrophysical Fluid Dynamics of Jovian Worlds (2023)</em>.</p>
            </div>
        </div>

        <!-- Right Column: Question Interface -->
        <div id="quiz-container" class="bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden">
            <!-- Progress Tracker -->
            <div class="p-6 border-b border-slate-100 bg-slate-50/50">
                <div class="flex justify-between text-[11px] font-extrabold text-slate-500 uppercase tracking-widest mb-3">
                    <span id="progress-text">Question 1 of 30</span>
                    <span id="topic-badge" class="bg-slate-800 text-white px-4 py-1 rounded-full shadow-sm">TOPIC</span>
                </div>
                <div class="w-full bg-slate-200 h-2.5 rounded-full overflow-hidden">
                    <div id="progress-bar" class="bg-indigo-600 h-full transition-all duration-700 ease-out" style="width: 3.33%"></div>
                </div>
            </div>

            <!-- Question Content -->
            <div id="question-area" class="p-10 flex-grow overflow-y-auto">
                <div id="hint-box" class="mb-6 p-5 bg-blue-50 border-l-4 border-blue-600 text-sm text-blue-900 hidden rounded-r-xl shadow-sm italic">
                    <!-- Hint text -->
                </div>
                
                <h2 id="question-text" class="text-xl font-bold text-slate-900 mb-10 leading-snug"></h2>

                <div id="options-list" class="space-y-4">
                    <!-- Options injected here -->
                </div>

                <!-- Feedback Area (Only in Review Mode) -->
                <div id="feedback-area" class="mt-12 p-8 rounded-2xl bg-slate-100 hidden border border-slate-200 shadow-sm">
                    <h3 class="font-bold text-xs mb-4 uppercase tracking-widest text-slate-500 border-b pb-2">Technical Rationale</h3>
                    <p id="explanation-text" class="text-sm leading-relaxed text-slate-700 font-medium"></p>
                </div>
            </div>

            <!-- Footer Controls -->
            <div class="p-6 border-t border-slate-100 bg-white flex justify-between items-center">
                <button id="prev-btn" class="px-8 py-3.5 text-xs font-black text-slate-600 bg-slate-100 rounded-xl hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-all uppercase tracking-widest">
                    PREVIOUS
                </button>
                <button id="hint-btn" class="text-xs font-black text-indigo-600 hover:text-indigo-800 transition-all border-b-2 border-transparent hover:border-indigo-600 uppercase tracking-widest">
                    REFERENCE PARA
                </button>
                <button id="next-btn" class="px-10 py-3.5 text-xs font-black text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all uppercase tracking-widest">
                    CONTINUE
                </button>
            </div>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="hidden fixed inset-0 bg-slate-900/70 backdrop-blur-xl z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-[2rem] shadow-2xl max-w-2xl w-full p-12 text-center transform scale-100 transition-transform">
            <div class="mb-10 inline-flex p-8 bg-indigo-50 text-indigo-600 rounded-full ring-8 ring-indigo-50/50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h2 class="text-4xl font-black text-slate-900 mb-4 tracking-tighter">Assessment Summary</h2>
            <p class="text-slate-500 font-semibold mb-12 text-lg">Detailed analysis of your reading proficiency across core academic domains.</p>
            
            <div class="grid grid-cols-2 gap-8 mb-12">
                <div class="p-8 bg-indigo-700 text-white rounded-3xl shadow-2xl flex flex-col items-center justify-center">
                    <span class="block text-6xl font-black mb-2" id="final-score">0</span>
                    <span class="text-[10px] font-black uppercase tracking-[0.2em] opacity-70">Total Correct / 30</span>
                </div>
                <div id="section-breakdown" class="text-left space-y-4 py-4 px-8 border-l-4 border-slate-100 flex flex-col justify-center">
                    <!-- Section scores -->
                </div>
            </div>

            <button id="review-btn" class="w-full py-6 bg-slate-900 text-white rounded-3xl font-black text-xl hover:bg-slate-800 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-2xl tracking-tight">
                ANALYZE MISTAKES
            </button>
        </div>
    </div>
</div>

<script>
    // --- PASSAGE DATA (High-Density Professional Text) ---
    const passages = {
        "Life Science": `
            <h2 class="text-3xl font-black mb-8 text-indigo-900 tracking-tight">Phenotypic Plasticity and Adaptive Diversification in Archipelagic Avifauna</h2>
            <p><strong>[Paragraph 1]</strong> Adaptive radiation is an evolutionary catalyst whereby a singular ancestral lineage rapidly bifurcates into diverse descendant species, each specialized for distinct ecological niches. This process is most profound within archipelagic systems, where geographic isolation serves as an effective barrier to gene flow, facilitating allopatric speciation. Upon colonizing a pristine archipelago, an ancestral population encounters an "adaptive landscape" devoid of established competitors. This ecological opportunity triggers intense selection pressures for resource specialization, driving radical morphological and behavioral divergence among sub-populations colonizing varied islands or altitudinal strata.</p>
            <p><strong>[Paragraph 2]</strong> The primary driver of this diversification is natural selection acting upon phenotypic traits that maximize foraging efficiency. In avian lineages, the bill is the critical interface with the environment, exhibiting high morphological plasticity. For example, populations in arid highlands may develop robust beaks for crushing calcified seeds, while those in rainforest lowlands evolve elongated bills for nectar extraction. Over time, these adaptations become genetically fixed, often leading to reproductive isolation. This divergence is exacerbated by character displacement—the phenomenon where coexisting, closely related species evolve more distinct traits to minimize direct competition for limited resources.</p>
            <p><strong>[Paragraph 3]</strong> However, the magnitude of radiation is constrained by the "genetic toolkit" of the ancestor. Genetic constraints may limit the range of viable phenotypic mutations. Furthermore, the topography of the archipelago is vital; a homogeneous island provides fewer niches, suppressing speciation. In contrast, islands with high topographical complexity and micro-climatic variation provide the substrate for extensive radiation. Behavioral shifts, such as altered mating displays or acoustic signaling, often precede physical divergence, acting as initial reproductive barriers that prevent hybridization between diverging lineages before substantial physiological differences occur.</p>
            <p><strong>[Paragraph 4]</strong> Modern phylogenomics has revealed that adaptive radiation is frequently facilitated by "hybrid swarms"—events where distinct colonizing lineages interbreed, producing a massive reservoir of genetic variation. This diversity allows for a more rapid response to novel selective pressures than would be possible through de novo mutations alone. Evidence suggests that regulatory genes, which govern the timing and spatial expression of development, are the primary loci of change in these bursts. By altering the expression of these master regulators, evolution can generate radically different body plans within relatively short geological windows, a process fundamental to the biodiversity observed in isolated island chains today.</p>
        `,
        "Social Science": `
            <h2 class="text-3xl font-black mb-8 text-indigo-900 tracking-tight">Socio-Economic Stratification and the Mechanization of Urban Labor</h2>
            <p><strong>[Paragraph 1]</strong> The transition from agrarian-centric economies to industrial urbanism during the late eighteenth century necessitated a total reconfiguration of the social fabric. This "Urban Revolution" was not merely a shift in demographic concentration but a fundamental restructuring of the relationship between labor, time, and the individual. Traditional rural life was anchored in the cyclical rhythms of the seasons and deeply integrated kinship networks. The industrial factory system, however, introduced "linear clock time," where labor was commodified into discrete, standardized units. This mechanization of human activity catalyzed a sense of alienation, as workers were systematically distanced from the holistic production process—a shift meticulously documented by social theorists of the period.</p>
            <p><strong>[Paragraph 2]</strong> From an economic perspective, the concentration of production in urban hubs triggered a self-sustaining growth cycle known as agglomeration. By clustering industries, firms benefited from shared infrastructure, specialized labor pools, and minimized transaction costs for raw materials. Yet, this efficiency was shadowed by severe social externalities. The velocity of urban migration consistently overwhelmed the development of sanitation and housing infrastructure. Consequently, the industrial city became synonymous with extreme density and the proliferation of tenements, where inadequate hygiene facilitated recurring outbreaks of communicative diseases like cholera, which disproportionately affected the laboring classes.</p>
            <p><strong>[Paragraph 3]</strong> Social stratification became increasingly rigid and visually pronounced. The emerging "industrial capitalist" class, often termed the nouveau riche, accumulated wealth that rivaled or surpassed that of the traditional landed aristocracy. Conversely, the urban proletariat faced subsistence-level compensation and precarious job security. This economic chasm fostered the emergence of class consciousness, leading to the formation of organized labor collectives. Trade unions and mutual-aid societies provided a new communal infrastructure, replacing rural kinship with collective bargaining power. These organizations were instrumental in lobbying for legislative interventions, such as the regulation of child labor and the establishment of workplace safety protocols.</p>
            <p><strong>[Paragraph 4]</strong> Despite these challenges, the industrial city functioned as a crucible for intellectual and cultural innovation. The high density of diverse populations accelerated the exchange of ideas, leading to the professionalization of scientific disciplines and the birth of modern artistic movements. Public institutions—libraries, museums, and urban parks—were often established with the dual purpose of "civilizing" the masses and maintaining social cohesion amidst potential unrest. While the early industrial era was characterized by profound inequality, the urban structure it created provided the foundational framework for the modern democratic state and the technological progress that would eventually elevate global living standards.</p>
        `,
        "Physical Science": `
            <h2 class="text-3xl font-black mb-8 text-indigo-900 tracking-tight">Fluid Dynamics and Atmospheric Zonalism in Gas Giants</h2>
            <p><strong>[Paragraph 1]</strong> The gas giants of our solar system—Jupiter and Saturn—differ fundamentally from terrestrial planets in their lack of a solid surface and their possession of massive atmospheres composed primarily of hydrogen and helium. These planets are essentially fluid bodies where the atmosphere transitions seamlessly from gas to a high-pressure liquid state. The visible surface is characterized by "atmospheric zonalism"—a system of alternating latitudinal bands known as zones (light-colored) and belts (dark-colored). These bands are formed by stable jet streams with velocities exceeding 400 kilometers per hour, driven by the planet's rapid axial rotation and the convection of internal thermal energy.</p>
            <p><strong>[Paragraph 2]</strong> A hallmark of these atmospheres is the presence of long-lived anticyclonic vortices, such as Jupiter's Great Red Spot. This storm system has persisted for centuries, sustained by the shear forces between opposing jet streams. Unlike terrestrial hurricanes, which lose energy upon making landfall or encountering cooler waters, Jovian storms are perpetually fueled by internal heat flux and are unhindered by solid boundaries. The vertical architecture of these storms involves the lofting of ammonia and sulfur compounds from deeper, warmer layers to the cooler upper atmosphere, where photochemical reactions with ultraviolet solar radiation produce the distinctive chromophores responsible for the storm's color.</p>
            <p><strong>[Paragraph 3]</strong> Thermal convection is the engine driving these complex atmospheric patterns. Gas giants radiate significantly more energy than they absorb from the Sun, indicating a potent internal heat source derived from gravitational contraction and the settling of helium toward the core. This internal heat flux creates large-scale convection cells: warm gas rises in the zones and cooler gas sinks in the belts. This circulation is further intensified by the latent heat released during the phase transitions of trace water and methane. This energy release powers mega-lightning events, which are significantly more powerful than anything observed on Earth, contributing to the chaotic turbulence of the cloud decks.</p>
            <p><strong>[Paragraph 4]</strong> In the deep interior, the atmospheric pressure reaches several million bars, forcing hydrogen into a "metallic" phase. In this state, hydrogen acts as an electrical conductor; its motion, driven by convection and rotation, generates a powerful magnetic field through a planetary dynamo. This magnetosphere extends millions of kilometers into space, interacting with the solar wind to create intense radiation belts. Current astrophysical missions seek to map the transition between the molecular outer atmosphere and the metallic interior, as this boundary is critical for understanding the thermal history and the structural evolution of the giant planets in our solar system and beyond.</p>
        `
    };

    // --- ORIGINAL QUESTIONS DATA (30 Questions) ---
    const questions = [
        // Life Science: 1-10
        { topic: "Life Science", text: "What is the primary role of 'geographical isolation' in archipelagic systems according to paragraph 1?", options: ["It prevents mutations from occurring in the ancestral lineage.", "It serves as a barrier to gene flow, enabling allopatric speciation.", "It encourages species to migrate back to the mainland.", "It ensures that the 'adaptive landscape' remains empty."], answer: 1, hint: "Check Para 1: 'geographic isolation serves as an effective barrier to gene flow...'", explanation: "Correct. The text states isolation is a barrier that allows for allopatric speciation." },
        { topic: "Life Science", text: "The word 'bifurcates' in paragraph 1 is closest in meaning to:", options: ["Combines", "Disappears", "Divides", "Weakens"], answer: 2, hint: "Context: 'lineage rapidly bifurcates into diverse descendant species'.", explanation: "Correct. Bifurcation refers to a split or division into two or more branches." },
        { topic: "Life Science", text: "According to paragraph 2, what causes the morphological specialization of avian bills?", options: ["The birds' desire to find more colorful mates.", "Random genetic drift unrelated to the environment.", "Selection for traits that maximize foraging efficiency.", "The gradual wearing down of beaks against different food types."], answer: 2, hint: "Para 2: 'selection acting upon phenotypic traits that maximize foraging efficiency'.", explanation: "Correct. Selection favors beaks that are best adapted to specific food sources." },
        { topic: "Life Science", text: "Which of the following is NOT mentioned in paragraph 3 as a constraint on adaptive radiation?", options: ["Genetic limitations of the ancestral species.", "The homogeneity of an island's environment.", "The lack of topographical complexity.", "The speed of the birds' migratory patterns."], answer: 3, hint: "Para 3 mentions 'genetic toolkit', 'homogeneous environment', and 'topographical complexity'.", explanation: "Correct. Migratory speed is not mentioned as a constraint." },
        { topic: "Life Science", text: "What can be inferred about 'behavioral shifts' from paragraph 3?", options: ["They only occur after a species has already fully diverged physically.", "They are less important than changes in bill shape.", "They can prevent interbreeding before major physical changes occur.", "They are the result of random mutations in regulatory genes."], answer: 2, hint: "Para 3: 'Behavioral shifts... often precede physical divergence... acting as initial reproductive barriers'.", explanation: "Correct. The text implies they act as a safeguard against hybridization." },
        { topic: "Life Science", text: "The word 'loci' in paragraph 4 is closest in meaning to:", options: ["Sizes", "Positions", "Results", "Methods"], answer: 1, hint: "Context: 'regulatory genes... are the primary loci of change'.", explanation: "Correct. Loci refers to specific locations or positions (in this case, on the genome)." },
        { topic: "Life Science", text: "How do 'hybrid swarms' influence evolutionary speed according to paragraph 4?", options: ["They slow down evolution by creating too much confusion.", "They provide a massive reservoir of genetic variation for selection.", "They prevent regulatory genes from functioning correctly.", "They eliminate the need for natural selection entirely."], answer: 1, hint: "Para 4: 'producing a massive reservoir of genetic variation... allows for a more rapid response'.", explanation: "Correct. More variation allows selection to act faster than waiting for new mutations." },
        { topic: "Life Science", text: "In paragraph 4, what is the significance of 'regulatory genes'?", options: ["They are the only genes that can be inherited.", "They control the timing and spatial expression of development.", "They prevent archipelagic species from interbreeding.", "They are found only in hybrid swarms."], answer: 1, hint: "Para 4: 'govern the timing and spatial expression of development'.", explanation: "Correct. Their role in master-regulating development allows for radical body changes." },
        { topic: "Life Science", text: "Which sentence best expresses the essential information in the following sentence: 'This divergence is exacerbated by character displacement—the phenomenon where coexisting, closely related species evolve more distinct traits to minimize direct competition for limited resources.'", options: ["Species living in the same area become more similar to share resources.", "Character displacement prevents species from living in the same environment.", "Competition with similar species causes a lineage to develop even more unique traits.", "Direct competition for resources is the only reason species ever diverge."], answer: 2, hint: "Focus on 'evolve more distinct traits' to 'minimize competition'.", explanation: "Correct. It highlights how coexistence drives further divergence to avoid conflict." },
        { topic: "Life Science", text: "Sentence Insertion: 'Consequently, a single species can quickly branch into many distinct forms.' Where would this fit best?", options: ["After the first sentence of Para 1.", "After 'allopatric speciation' in Para 1.", "Before 'Under these conditions' in Para 1.", "At the end of Para 4."], answer: 0, hint: "It elaborates on the initial definition of adaptive radiation provided in the first sentence.", explanation: "Correct. It serves as a concluding thought to the definition of 'branching' evolution." },

        // Social Science: 11-20
        { topic: "Social Science", text: "According to paragraph 1, how did the factory system change the concept of labor?", options: ["It made labor more enjoyable and less repetitive.", "It introduced 'linear clock time' where labor became a commodity.", "It strengthened kinship networks in the city.", "It allowed workers to be more involved in the final products."], answer: 1, hint: "Para 1: 'introduced linear clock time, where labor was commodified'.", explanation: "Correct. The move from seasonal to clock-based labor is the central point." },
        { topic: "Social Science", text: "The word 'precipitated' in paragraph 1 is closest in meaning to:", options: ["Prevented", "Triggered", "Delayed", "Simplified"], answer: 1, hint: "Context: 'transition... precipitated a total reconfiguration'.", explanation: "Correct. It means to cause something to happen suddenly." },
        { topic: "Social Science", text: "What is 'agglomeration' as described in paragraph 2?", options: ["The spread of diseases in urban centers.", "The movement of industrial workers back to the countryside.", "The economic benefit of clustering industries in a single hub.", "The development of housing infrastructure for the poor."], answer: 2, hint: "Para 2: 'clustering industries... firms benefited from shared infrastructure... known as agglomeration'.", explanation: "Correct. It describes the positive economic externalities of proximity." },
        { topic: "Social Science", text: "Why was the industrial city associated with disease outbreaks?", options: ["Migrants brought diseases from the rural areas.", "Rapid urban migration outpaced the growth of sanitation systems.", "Factories produced toxic waste that was dumped into the streets.", "The capitalist class intentionally made the workers sick."], answer: 1, hint: "Para 2: 'velocity of urban migration consistently overwhelmed the development of sanitation'.", explanation: "Correct. The lack of infrastructure relative to population growth was the cause." },
        { topic: "Social Science", text: "The word 'externalities' in paragraph 2 is closest in meaning to:", options: ["Economic profits", "Internal factors", "Unintended side effects", "Future goals"], answer: 2, hint: "Context: 'efficiency was shadowed by severe social externalities'.", explanation: "Correct. Externalities are consequences of industrial activity that affect other parties." },
        { topic: "Social Science", text: "In paragraph 3, what was the primary response to the 'economic chasm' between classes?", options: ["The creation of more factories.", "The formation of organized labor collectives and trade unions.", "A return to the traditional landed aristocracy.", "The abolition of child labor by the capitalist class."], answer: 1, hint: "Para 3: 'fostered the emergence of class consciousness, leading to the formation of organized labor collectives'.", explanation: "Correct. Unions emerged as a direct response to the inequality." },
        { topic: "Social Science", text: "According to paragraph 3, what role did trade unions play in the industrial city?", options: ["They helped the nouveau riche manage their wealth.", "They replaced the rural kinship system with a collective identity.", "They prevented workers from learning new scientific ideas.", "They encouraged people to move back to farms."], answer: 1, hint: "Para 3: 'provided a new communal infrastructure, replacing rural kinship'.", explanation: "Correct. They provided social and political support for workers." },
        { topic: "Social Science", text: "What was the 'dual purpose' of public institutions mentioned in paragraph 4?", options: ["To make money and to build libraries.", "To educate the rich and to control the poor.", "To civilize the masses and maintain social cohesion.", "To replace factories and increase sanitation."], answer: 2, hint: "Para 4: 'purpose of civilizing the masses and maintaining social cohesion'.", explanation: "Correct. They were meant for both 'uplift' and social control." },
        { topic: "Social Science", text: "The word 'precarious' in paragraph 3 is closest in meaning to:", options: ["Stable", "High-paying", "Insecure", "Traditional"], answer: 2, hint: "Context: 'precarious job security'.", explanation: "Correct. Precarious means uncertain or unstable." },
        { topic: "Social Science", text: "Which of the following is NOT mentioned in paragraph 4 as a positive outcome of industrial urbanization?", options: ["Professionalization of scientific disciplines.", "Accelerated exchange of ideas.", "The creation of urban parks.", "The complete elimination of poverty."], answer: 3, hint: "Para 4 mentions science, ideas, and parks, but acknowledges inequality remained.", explanation: "Correct. The text says early industrial era was characterized by 'profound inequality'." },

        // Physical Science: 21-30
        { topic: "Physical Science", text: "According to paragraph 1, how do gas giants differ from terrestrial planets?", options: ["They have solid surfaces but no atmospheres.", "They lack a solid surface and are primarily hydrogen and helium.", "They do not rotate on their axes.", "They possess much thinner atmospheres."], answer: 1, hint: "Para 1: 'differ fundamentally... in their lack of a solid surface'.", explanation: "Correct. Their fluid nature is the key differentiator." },
        { topic: "Physical Science", text: "What drives the high-velocity jet streams in the Jovian atmosphere?", options: ["Solar winds from the Sun.", "Rapid axial rotation and internal thermal convection.", "The presence of solid boundaries like mountains.", "The gravitational pull of the inner moons."], answer: 1, hint: "Para 1: 'driven by the planet's rapid axial rotation and the convection of internal thermal energy'.", explanation: "Correct. These two forces combine to power the winds." },
        { topic: "Physical Science", text: "The word 'sustained' in paragraph 2 is closest in meaning to:", options: ["Damaged", "Maintained", "Weakened", "Observed"], answer: 1, hint: "Context: 'storm system... sustained by the shear forces'.", explanation: "Correct. Sustained means kept in existence or maintained." },
        { topic: "Physical Science", text: "Why do Jovian storms last much longer than those on Earth?", options: ["They are located further from the Sun.", "They are powered by internal heat and lack solid land to disrupt them.", "They are made of ammonia ice crystals which do not melt.", "They are held in place by powerful magnetic fields."], answer: 1, hint: "Para 2: 'perpetually fueled by internal heat flux and are unhindered by solid boundaries'.", explanation: "Correct. No land to stop the momentum and a constant heat source." },
        { topic: "Physical Science", text: "What creates the colors observed in Jupiter's Great Red Spot?", options: ["The reflection of sunlight off metallic hydrogen.", "Chemicals reacting with ultraviolet solar radiation.", "Heat coming directly from the core.", "The high pressure turning hydrogen into a liquid."], answer: 1, hint: "Para 2: 'photochemical reactions with ultraviolet solar radiation produce the distinctive chromophores'.", explanation: "Correct. Light reacts with chemicals to create the visible colors." },
        { topic: "Physical Science", text: "The word 'potent' in paragraph 3 is closest in meaning to:", options: ["Silent", "Powerful", "Hidden", "Temporary"], answer: 1, hint: "Context: 'indicating a potent internal heat source'.", explanation: "Correct. Potent means strong or powerful." },
        { topic: "Physical Science", text: "What evidence suggests that gas giants have an internal heat source?", options: ["They have massive lightning storms.", "They radiate more energy than they absorb from the Sun.", "They have magnetic fields that generate heat.", "They are composed mostly of helium."], answer: 1, hint: "Para 3: 'radiate significantly more energy than they absorb from the Sun'.", explanation: "Correct. This thermal excess is proof of internal heat." },
        { topic: "Physical Science", text: "How does 'latent heat' contribute to Jovian atmospheric patterns?", options: ["It causes the planet to spin faster.", "It provides additional energy for circulation and lightning.", "It turns hydrogen into a solid metal.", "It prevents ammonia from rising."], answer: 1, hint: "Para 3: 'latent heat released... adding further energy to the atmospheric circulation'.", explanation: "Correct. Phase transitions release energy that fuels turbulence." },
        { topic: "Physical Science", text: "What is 'metallic hydrogen' and what is its primary effect?", options: ["It is a solid shell that protects the core.", "It is a conductive phase that generates a magnetic field.", "It is a gas that creates the belts and zones.", "It is a substance that cools the planet's interior."], answer: 1, hint: "Para 4: 'acts as an electrical conductor; its motion... generates a powerful magnetic field'.", explanation: "Correct. This conductive layer allows for the dynamo effect." },
        { topic: "Physical Science", text: "Sentence Insertion: 'This rapid bombardment is only possible in environments with extremely high neutron density.' Where would this fit best? (Based on the text logic)", options: ["After 'zonalism' in Para 1.", "After 'dynamo' in Para 4.", "After 'phase transitions' in Para 3.", "It doesn't fit in this specific text."], answer: 3, hint: "The sentence refers to 'neutron density' which is an R-process concept from nuclear physics, not fluid dynamics.", explanation: "Correct. This specific sentence belongs in a passage about stellar nucleosynthesis, not atmospheric dynamics." }
    ];

    let currentQuestionIndex = 0;
    let userAnswers = new Array(questions.length).fill(null);
    let isReviewMode = false;
    let timerInterval;
    let secondsElapsed = 0;

    // DOM Elements
    const passageContent = document.getElementById('passage-content');
    const questionText = document.getElementById('question-text');
    const optionsList = document.getElementById('options-list');
    const feedbackArea = document.getElementById('feedback-area');
    const explanationText = document.getElementById('explanation-text');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const hintBtn = document.getElementById('hint-btn');
    const hintBox = document.getElementById('hint-box');
    const progressText = document.getElementById('progress-text');
    const progressBar = document.getElementById('progress-bar');
    const topicBadge = document.getElementById('topic-badge');
    const resultsScreen = document.getElementById('results-screen');
    const timerDisplay = document.getElementById('timer-display');

    function startTimer() {
        timerInterval = setInterval(() => {
            secondsElapsed++;
            const hrs = String(Math.floor(secondsElapsed / 3600)).padStart(2, '0');
            const mins = String(Math.floor((secondsElapsed % 3600) / 60)).padStart(2, '0');
            const secs = String(secondsElapsed % 60).padStart(2, '0');
            timerDisplay.innerText = `${hrs}:${mins}:${secs}`;
        }, 1000);
    }

    function initQuiz() {
        startTimer();
        renderQuestion();
    }

    function renderQuestion() {
        const q = questions[currentQuestionIndex];
        
        // Update Metadata
        progressText.innerText = `Question ${currentQuestionIndex + 1} of ${questions.length}`;
        progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
        topicBadge.innerText = q.topic;
        
        // Update Passage Side
        passageContent.innerHTML = passages[q.topic];
        
        // Scroll to top of passage when topic changes
        if (currentQuestionIndex === 0 || questions[currentQuestionIndex].topic !== questions[currentQuestionIndex-1]?.topic) {
            document.getElementById('passage-container').scrollTop = 0;
        }

        // Reset Hint
        hintBox.classList.add('hidden');
        
        // Update Question
        questionText.innerText = q.text;
        optionsList.innerHTML = '';
        
        q.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = `w-full text-left p-6 rounded-2xl border-2 border-slate-200 transition-all flex items-start group hover:border-indigo-400 hover:bg-indigo-50/30`;
            
            const label = String.fromCharCode(65 + index); // A, B, C, D
            btn.innerHTML = `
                <span class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center font-black text-slate-500 mr-6 group-hover:bg-indigo-600 group-hover:text-white transition-all transform group-hover:scale-110 shadow-sm">${label}</span> 
                <span class="flex-grow pt-0.5 font-semibold text-slate-700 leading-snug">${opt}</span>
            `;
            
            // Handle Selection
            if (userAnswers[currentQuestionIndex] === index) {
                btn.classList.add('selected', 'border-indigo-600', 'bg-indigo-50');
                btn.querySelector('span').classList.replace('bg-slate-100', 'bg-indigo-600');
                btn.querySelector('span').classList.replace('text-slate-500', 'text-white');
            }

            if (isReviewMode) {
                if (index === q.answer) {
                    btn.classList.add('correct', 'border-emerald-500', 'bg-emerald-50');
                    btn.querySelector('span').classList.replace('bg-slate-100', 'bg-emerald-600');
                    btn.querySelector('span').classList.replace('text-slate-500', 'text-white');
                } else if (userAnswers[currentQuestionIndex] === index) {
                    btn.classList.add('incorrect', 'border-rose-500', 'bg-rose-50');
                    btn.querySelector('span').classList.replace('bg-slate-100', 'bg-rose-600');
                    btn.querySelector('span').classList.replace('text-slate-500', 'text-white');
                }
                btn.disabled = true;
                btn.classList.remove('hover:border-indigo-400', 'hover:bg-indigo-50/30');
            } else {
                btn.onclick = () => selectOption(index);
            }
            
            optionsList.appendChild(btn);
        });

        // Show Feedback in Review Mode
        if (isReviewMode) {
            feedbackArea.classList.remove('hidden');
            explanationText.innerHTML = q.explanation;
        } else {
            feedbackArea.classList.add('hidden');
        }

        // Nav Buttons
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.innerText = currentQuestionIndex === questions.length - 1 ? (isReviewMode ? "RESTART" : "FINISH TEST") : "CONTINUE";
    }

    function selectOption(index) {
        userAnswers[currentQuestionIndex] = index;
        renderQuestion();
    }

    function nextQuestion() {
        if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            renderQuestion();
            document.getElementById('question-area').scrollTop = 0;
        } else {
            if (isReviewMode) {
                location.reload();
            } else {
                clearInterval(timerInterval);
                showResults();
            }
        }
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            renderQuestion();
            document.getElementById('question-area').scrollTop = 0;
        }
    }

    function showHint() {
        hintBox.innerText = questions[currentQuestionIndex].hint;
        hintBox.classList.remove('hidden');
    }

    function showResults() {
        resultsScreen.classList.remove('hidden');
        
        let score = 0;
        userAnswers.forEach((ans, i) => {
            if (ans === questions[i].answer) score++;
        });
        
        document.getElementById('final-score').innerText = score;
        
        // Breakdown
        const breakdown = document.getElementById('section-breakdown');
        breakdown.innerHTML = `
            <div class="space-y-4">
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]">Module Performance</p>
                <div class="flex justify-between items-center text-sm">
                    <span class="text-slate-600 font-bold">Life Science</span>
                    <span class="bg-indigo-50 text-indigo-700 px-4 py-1 rounded-full font-black ring-1 ring-indigo-200">${calculateSection(0, 9)}/10</span>
                </div>
                <div class="flex justify-between items-center text-sm">
                    <span class="text-slate-600 font-bold">Social Science</span>
                    <span class="bg-indigo-50 text-indigo-700 px-4 py-1 rounded-full font-black ring-1 ring-indigo-200">${calculateSection(10, 19)}/10</span>
                </div>
                <div class="flex justify-between items-center text-sm">
                    <span class="text-slate-600 font-bold">Physical Science</span>
                    <span class="bg-indigo-50 text-indigo-700 px-4 py-1 rounded-full font-black ring-1 ring-indigo-200">${calculateSection(20, 29)}/10</span>
                </div>
            </div>
        `;
    }

    function calculateSection(start, end) {
        let s = 0;
        for(let i=start; i<=end; i++) {
            if(userAnswers[i] === questions[i].answer) s++;
        }
        return s;
    }

    function reviewMistakes() {
        isReviewMode = true;
        currentQuestionIndex = 0;
        resultsScreen.classList.add('hidden');
        renderQuestion();
    }

    // Event Listeners
    nextBtn.onclick = nextQuestion;
    prevBtn.onclick = prevQuestion;
    hintBtn.onclick = showHint;
    document.getElementById('review-btn').onclick = reviewMistakes;

    initQuiz();
</script>
</body>
</html>
